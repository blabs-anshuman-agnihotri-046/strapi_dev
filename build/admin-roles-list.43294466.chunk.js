"use strict";(self.webpackChunkcms_survivor=self.webpackChunkcms_survivor||[]).push([[3455],{51754:(b,c,t)=>{t.d(c,{F:()=>r});var e=t(68835),l=t(86896),o=t(88767);const r=(m={},A={})=>{const{id:T="",...M}=m,{get:B}=(0,e.kY)(),{locale:i}=(0,l.Z)(),j=(0,e.Xe)(i,{sensitivity:"base"}),{data:f,error:K,isError:u,isLoading:C,refetch:V}=(0,o.useQuery)(["roles",T,M],async()=>{const{data:I}=await B(`/admin/roles/${T??""}`,{params:M});return I},A);let Z=[];return T&&f?Z=[f.data]:Array.isArray(f?.data)&&(Z=f.data),{roles:Z.sort((I,w)=>j.compare(I.name,w.name)),error:K,isError:u,isLoading:C,refetch:V}}},7513:(b,c,t)=>{t.r(c),t.d(c,{default:()=>ue});var e=t(67294),l=t(68835),o=t(86706),r=t(36364),m=t(40720),A=t(90731),T=t(12473),M=t(55040),B=t(34726),i=t(5923),j=t(38454),f=t(3547),K=t(29299),u=t(69398),C=t(10574),V=t(22304),Z=t(35752),I=t(43838),w=t(2382),J=t(54425),G=t(83598),H=t(86896),q=t(16550),_=t(51754);const ee=()=>"todo empty role";var te=t(96987),le=t(16607),ne=t(96208),se=t(45697),R=t.n(se);const k=({id:s,name:E,description:a,usersCount:x,icons:d,rowIndex:W,canUpdate:g})=>{const{formatMessage:y}=(0,H.Z)(),[,L]=d,h=y({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:x});return e.createElement(K.Tr,{"aria-rowindex":W,key:s,...g?(0,l.X7)({fn:L.onClick}):{}},e.createElement(u.Td,{maxWidth:(0,l.Q1)(130)},e.createElement(C.Z,{ellipsis:!0,textColor:"neutral800"},E)),e.createElement(u.Td,{maxWidth:(0,l.Q1)(250)},e.createElement(C.Z,{ellipsis:!0,textColor:"neutral800"},a)),e.createElement(u.Td,null,e.createElement(C.Z,{textColor:"neutral800"},h)),e.createElement(u.Td,null,e.createElement(te.k,{justifyContent:"flex-end",...l.UW},d.map((v,O)=>v?e.createElement(le.x,{key:v.label,paddingLeft:O===0?0:1},e.createElement(ne.h,{onClick:v.onClick,label:v.label,noBorder:!0,icon:v.icon})):null))))};k.propTypes={id:R().number.isRequired,name:R().string.isRequired,description:R().string.isRequired,usersCount:R().number.isRequired,icons:R().array.isRequired,rowIndex:R().number.isRequired,canUpdate:R().bool},k.defaultProps={canUpdate:!1};const ae=k;var oe=t(18172);const re={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},ie=(s,E)=>(0,oe.ZP)(s,a=>{switch(E.type){case"ON_REMOVE_ROLES":{a.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{a.shouldRefetchData=!0,a.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{a.shouldRefetchData=!1,a.roleToDelete=null,a.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{a.roleToDelete=E.id;break}default:return a}}),de=({canCreate:s,canDelete:E,canUpdate:a,refetchRoles:x})=>{const{formatMessage:d}=(0,H.Z)(),{formatAPIError:W}=(0,l.So)(),g=(0,l.lm)(),[y,L]=(0,e.useState)(!1),{push:h}=(0,q.k6)(),[{selectedRoles:v,showModalConfirmButtonLoading:O,roleToDelete:Q},U]=(0,e.useReducer)(ie,re),{post:z}=(0,l.tg)(),X=async()=>{try{U({type:"ON_REMOVE_ROLES"}),await z("/admin/roles/batch-delete",{ids:[Q]}),await x(),U({type:"RESET_DATA_TO_DELETE"})}catch(n){g({type:"warning",message:W(n)})}P()},$=(0,e.useCallback)(n=>{h(`/settings/roles/duplicate/${n}`)},[h]),F=()=>h("/settings/roles/new"),S=(0,e.useCallback)(n=>{U({type:"SET_ROLE_TO_DELETE",id:n}),P()},[]),P=()=>L(n=>!n),p=(0,e.useCallback)(n=>{h(`/settings/roles/${n}`)},[h]),N=(0,e.useCallback)((n,D)=>{n.preventDefault(),n.stopPropagation(),D.usersCount?g({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):S(D.id)},[g,S]),Y=(0,e.useCallback)((n,D)=>{n.preventDefault(),n.stopPropagation(),$(D.id)},[$]),me=(0,e.useCallback)(n=>[...s?[{onClick:D=>Y(D,n),label:d({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(I.Z,null)}]:[],...a?[{onClick:()=>p(n.id),label:d({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(w.Z,null)}]:[],...E?[{onClick:D=>N(D,n),label:d({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(J.Z,null)}]:[]],[d,N,Y,p,s,a,E]);return{handleNewRoleClick:F,getIcons:me,selectedRoles:v,isWarningDeleteAllOpened:y,showModalConfirmButtonLoading:O,handleToggleModal:P,handleDeleteData:X}},ce=()=>{const{formatMessage:s}=(0,H.Z)();(0,l.go)();const E=(0,o.v9)(r._),[{query:a}]=(0,l.Kx)(),{isLoading:x,allowedActions:{canCreate:d,canDelete:W,canRead:g,canUpdate:y}}=(0,l.ss)(E.settings.roles),{roles:L,isLoading:h,refetch:v}=(0,_.F)({filters:a?._q?{name:{$containsi:a._q}}:void 0},{cacheTime:0,enabled:!x&&g}),{handleNewRoleClick:O,getIcons:Q,isWarningDeleteAllOpened:U,showModalConfirmButtonLoading:z,handleToggleModal:X,handleDeleteData:$}=de({refetchRoles:v,canCreate:d,canDelete:W,canUpdate:y}),F=L.length+1,S=6;if(x)return e.createElement(m.o,null,e.createElement(l.dO,null));const P=s({id:"global.roles",defaultMessage:"roles"});return e.createElement(m.o,null,e.createElement(l.SL,{name:"Roles"}),e.createElement(A.T,{primaryAction:d?e.createElement(T.z,{onClick:O,startIcon:e.createElement(G.Z,null),size:"S"},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:P,subtitle:s({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),g&&e.createElement(M.Z,{startActions:e.createElement(l.m,{label:s({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:P})})}),g&&e.createElement(B.D,null,e.createElement(i.i,{colCount:S,rowCount:F,footer:d?e.createElement(j.c,{onClick:O,icon:e.createElement(G.Z,null)},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(f.h,null,e.createElement(K.Tr,{"aria-rowindex":1},e.createElement(u.Th,null,e.createElement(C.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.name",defaultMessage:"Name"}))),e.createElement(u.Th,null,e.createElement(C.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.description",defaultMessage:"Description"}))),e.createElement(u.Th,null,e.createElement(C.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.users",defaultMessage:"Users"}))),e.createElement(u.Th,null,e.createElement(V.T,null,s({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Z.p,null,L?.map((p,N)=>e.createElement(ae,{key:p.id,id:p.id,name:p.name,description:p.description,usersCount:p.usersCount,icons:Q(p),rowIndex:N+2,canUpdate:y})))),!F&&!h&&e.createElement(ee,null)),e.createElement(l.QH,{isOpen:U,onConfirm:$,isConfirmButtonLoading:z,onToggleDialog:X}))},ue=()=>{const s=(0,o.v9)(r._);return e.createElement(l.O4,{permissions:s.settings.roles.main},e.createElement(ce,null))}},55040:(b,c,t)=>{t.d(c,{Z:()=>o});var e=t(85893),l=t(96987);const o=({startActions:r,endActions:m})=>!r&&!m?null:(0,e.jsxs)(l.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,e.jsx)(l.k,{gap:2,wrap:"wrap",children:r}),(0,e.jsx)(l.k,{gap:2,shrink:0,wrap:"wrap",children:m})]})},38454:(b,c,t)=>{t.d(c,{c:()=>B});var e=t(85893),l=t(88972),o=t(16607),r=t(26910),m=t(96987),A=t(10574);const T=(0,l.ZP)(o.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:i})=>i.colors.primary600};
  }
`,M=(0,l.ZP)(o.x)`
  border-radius: 0 0 ${({theme:i})=>i.borderRadius} ${({theme:i})=>i.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,B=({children:i,icon:j,...f})=>(0,e.jsxs)("div",{children:[(0,e.jsx)(r.i,{}),(0,e.jsx)(M,{as:"button",background:"primary100",padding:5,...f,children:(0,e.jsxs)(m.k,{children:[(0,e.jsx)(T,{"aria-hidden":!0,background:"primary200",children:j}),(0,e.jsx)(o.x,{paddingLeft:3,children:(0,e.jsx)(A.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:i})})]})})]})},43838:(b,c,t)=>{t.d(c,{Z:()=>o});var e=t(85893);const l=r=>(0,e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...r,children:[(0,e.jsx)("path",{fill:"#212134",d:"M1.056 24h15.906c.583 0 1.056-.473 1.056-1.056V7.028c0-.583-.473-1.056-1.056-1.056H1.056C.473 5.972 0 6.445 0 7.028v15.916C0 23.527.473 24 1.056 24Z"}),(0,e.jsx)("path",{fill:"#212134",d:"M8.094 2.111h13.795v13.795h-1.127v2.112h2.182A1.056 1.056 0 0 0 24 16.962V1.056A1.056 1.056 0 0 0 22.944 0H7.038a1.056 1.056 0 0 0-1.056 1.056v2.252h2.112V2.11Z"})]}),o=l}}]);
